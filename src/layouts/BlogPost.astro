---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import Layout from './Main.astro';
import FormattedDate from '../components/FormattedDate.astro';


type CollectionProps = CollectionEntry<'blog'>['data'];
interface Props extends CollectionProps {
	updatedDate: Date;
}

const { title, description, pubDate, updatedDate, cover } = Astro.props;
---
<Layout title={title} description={description}>
	<article>
		<div class="max-w-full">
			<Image width={1020} height={510} src={cover} alt={description} loading="eager" class="mx-auto rounded-xl shadow-md shadow-boxshadow" />
		</div>
		<div class="w-8/12 max-w-full m-auto p-2 text-primary">
			<div class="mb-2 py-2 text-center">
				<div class="mb-1 text-secondary">
					<FormattedDate date={pubDate} />
					<!--
						TODO: add a git hook to populate missing publish times.
						This code is meant to hide the last updated time if it's close to the publish time.
						Since publish time is done manually and delays can happen, we have a long 1h grace period
					-->
					{ (updatedDate.getTime() - pubDate.getTime()) > (1000 * 60 * 60) &&
						<div class="italic">
							Last updated on <FormattedDate date={updatedDate} />
						</div>
					}
				</div>
				<h1 class="text-6xl mb-12">{title}</h1>
				<hr />
			</div>
			<slot />
		</div>
	</article>
</Layout>
